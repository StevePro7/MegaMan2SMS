.ifndef __BUBBLEMAN_STAGE_INC__
.define __BUBBLEMAN_STAGE_INC__

.slot 2
.section "bubblemanStage.tiles" superfree
bubblemanStage.tiles:
	.incbin "imagens\bubblemanstage.psgcompr" skip 2
.ends

.slot 2
.section "bubblemanStage.metaTiles" free
bubblemanStage.metaTiles:
	.dw $00FE
	.db $00 $A5 $01 $62 $FE $FF $1F $4C $5C $FD $FE $FC $A9 $02 $FA $FD
	.db $FB $1E $B3 $E7 $65 $7D $08 $F9 $73 $02 $D3 $F2 $F8 $36 $7E $CB
	.db $42 $F7 $C8 $F5 $76 $7E $EA $44 $F4 $E7 $89 $F2 $0A $C8 $F1 $5D
	.db $67 $E3 $E4 $F0 $3F $F2 $EF $27 $EE $E7 $83 $E7 $82 $E7 $81 $E7
	.db $80 $EC $00
.ends

.slot 2
.section "bubblemanStage.maps" superfree
bubblemanStage.maps:
bubblemanStage.map.0:
	.db $00 $56 $01 $02 $91 $0F $B7 $0A $20 $5D $88 $02 $03 $F3 $42 $20
	.db $20 $FA $42 $A0 $BC $02 $47 $03 $9A $A6 $17 $20 $D2 $3F $80 $34
	.db $5C $68 $20 $02 $42 $03 $FE $47 $80 $E6 $5C $8D $20 $08 $02 $03
	.db $5F $CA $00 $55 $B8 $53 $80 $FE $42 $A0 $AB $42 $20 $BF $A1 $02
	.db $03 $1E $11 $02 $03 $BF $CD $04 $04 $0D $01 $66 $20 $F7 $0B $17
	.db $C0 $45 $04 $74 $01 $25 $53 $2A $00 $90 $2D $A7 $3A $80 $FA $16
	.db $60 $DA $02 $1A $C7 $20 $B4 $1A $69 $20 $F7 $EC $6A $DC $3F $C7
	.db $9A $0C $35 $40 $B8 $7F $8F $34 $04 $2E $20 $5C $60 $BB $56 $1D
	.db $D1 $01 $C8 $05 $5A $10 $27 $06 $07 $53 $08 $01 $42 $36 $42 $10
	.db $91 $20 $AB $11 $02 $03 $E1 $02 $03 $1F $BD $18 $FC $05 $A7 $01
	.db $9F $09 $E1 $C8 $24 $1D $09 $6B $01 $48 $10 $5D $BB $C7 $A7 $D8
	.db $F7 $BF $C2 $EF $43 $F4 $D0 $F7 $D8 $00
bubblemanStage.map.1:
	.db $05 $AD $01 $90 $08 $F1 $09 $0A $07 $F8 $78 $0B $0C $82 $1F $20
	.db $CD $44 $1A $10 $61 $44 $0D $0E $0F $4B $30 $65 $24 $10 $6C $30
	.db $10 $8F $68 $A2 $21 $20 $68 $B1 $45 $0A $68 $10 $0C $43 $11 $90
	.db $60 $B9 $0A $80 $A4 $7F $20 $47 $60 $B4 $2C $10 $12 $A7 $50 $02
	.db $13 $14 $15 $16 $34 $0A $17 $18 $19 $1A $30 $70 $1B $1C $29 $1D
	.db $1E $60 $C0 $1F $20 $21 $22 $8D $02 $23 $24 $25 $26 $3C $29 $27
	.db $28 $90 $FE $85 $E0 $76 $A5 $C0 $73 $AA $10 $3C $D1 $A2 $50 $A4
	.db $79 $20 $0A $51 $56 $E0 $11 $0A $10 $B4 $6C $10 $0C $A5 $51 $A1
	.db $50 $B4 $42 $2D $7E $0A $20 $41 $1E $A1 $A0 $41 $48 $4E $48 $10
	.db $F2 $33 $2F $46 $5C $01 $46 $10 $9A $BD $3C $DE $8D $10 $B4 $5F
	.db $3D $3E $A1 $41 $2C $6A $00 $57 $34 $A4 $69 $32 $0D $81 $1B $80
	.db $D1 $FE $E4 $2B $70 $47 $90 $C8 $05 $CE $FE $2B $FE $68 $10 $52
	.db $17 $F0 $34 $E3 $2F $90 $42 $70 $91 $22 $A2 $0C $47 $91 $AB $90
	.db $C8 $E0 $75 $21 $50 $F2 $16 $70 $D0 $45 $70 $E4 $24 $22 $3A $20
	.db $43 $30 $F9 $4F $50 $96 $2A $BE $42 $5C $9A $58 $4F $2E $23 $0E
	.db $4D $20 $1A $2E $43 $30 $29 $10 $01 $2E $40 $FE $53 $09 $30 $D4
	.db $50 $E4 $64 $4A $12 $20 $39 $A7 $32 $80 $D0 $01 $D3 $3F $F0 $4D
	.db $D0 $F5 $DF $30 $58 $30 $AA $6B $60 $B5 $70 $14 $12 $40 $E5 $89
	.db $E0 $0E $40 $59 $E0 $AD $37 $EF $58 $E0 $A2 $05 $34 $87 $60 $AC
	.db $E0 $26 $F0 $C9 $4D $30 $FA $BC $D0 $D3 $39 $2E $B0 $D4 $00 $EF
	.db $78 $A5 $A0 $F3 $42 $25 $10 $BD $A3 $1D $10 $56 $4A $0C $29 $41
	.db $19 $D4 $0F $20 $E4 $2F $10 $93 $6A $C0 $38 $05 $DD $62 $F9 $0A
	.db $80 $68 $61 $80 $DB $46 $A1 $A0 $D1 $20 $B9 $AC $E4 $30 $FB $AD
	.db $29 $20 $C1 $01 $8A $04 $06 $07 $10 $53 $70 $1F $D1 $20 $20 $A2
	.db $29 $C7 $A0 $A0 $20 $48 $02 $EE $F6 $40 $8D $02 $23 $0F $6E $11
	.db $C5 $02 $03 $69 $20 $A1 $20 $20 $7D $21 $80 $54 $FF $C2 $15 $54
	.db $E1 $1B $68 $A3 $80 $DB $47 $A3 $20 $A5 $6F $60 $F5 $7E $40 $68
	.db $7C $20 $D0 $02 $03 $8F $F2 $3F $E0 $B4 $5E $68 $20 $02 $47 $03
	.db $D2 $25 $89 $3D $40 $22 $B0 $24 $11 $40 $7A $46 $D0 $85 $20 $A1
	.db $10 $29 $97 $48 $20 $D1 $2A $94 $02 $2B $20 $E0 $2C $2D $2E $59
	.db $2F $10 $A0 $2C $30 $31 $34 $2F $32 $03 $CA $50 $38 $33 $D8 $B0
	.db $21 $08 $BD $53 $01 $47 $10 $AA $94 $00 $91 $10 $96 $64 $5E $F2
	.db $70 $F4 $B2 $50 $ED $0E $30 $FF $46 $01 $D8 $00z
.ends

.slot 2
.section "bubblemanStage.transitions" superfree
bubblemanStage.stageLoader:	
	.db :bubblemanStage.tiles
	.db 186
	.dw bubblemanStage.tiles

	.db :bubblemanStage.metaTiles
	.dw bubblemanStage.metaTiles

	.db :bubblemanStage.maps
	
bubblemanStage.transition.0:
	.db LoadNewPaletteFlag | CheckpointFlag | EndingTransitionsFlag | LoadGameplayMapFlag
	
	;checkpoint megaman start position
	.db $64
	
	;palette
	.db $00 $34 $3F $02 $2A $14 $2F $1D 
	paletteAnimationSetUp 7, 3, 3
	.db $3f, $39, $34
    .db $39, $34, $3f
	.db $34, $3f, $39 
	;border color
	.db PaletteNewAddressMark | 16
	.db PaletteEndingMark | $39
	
	configureNextTransitions TransitB, bubblemanStage.transition.1
	
	;new map to load
	.dw bubblemanStage.map.0
	
	configureMapLimits OrientationFoward, OrientationHor, 0, 5
	
bubblemanStage.transition.1:
	.db EndingTransitionsFlag

	configureNextTransitions TransitB, bubblemanStage.transition.2
	configureMapLimits OrientationFoward, OrientationVert, 5, 3 

bubblemanStage.transition.2:
	.db LoadNewPaletteFlag | CheckpointFlag | EndingTransitionsFlag | LoadGameplayMapFlag
	
	;new palette (border)
	.db PaletteNewAddressMark | 16
	.db PaletteEndingMark | $34

	configureNextTransitions TransitR, bubblemanStage.transition.3
	
	;new map to load
	.dw bubblemanStage.map.1
	
	configureMapLimits OrientationFoward, OrientationHor, 0, 7

bubblemanStage.transition.3:
	.db LoadNewPaletteFlag | EndingTransitionsFlag
	
	;new palette (border)
	.db PaletteNewAddressMark | 16
	.db PaletteEndingMark | $39

	configureNextTransitions TransitR, bubblemanStage.transition.4
	configureMapLimits OrientationFoward, OrientationHor, 7, 5

bubblemanStage.transition.4:
	.db CheckpointFlag | EndingTransitionsFlag
	
	configureNextTransitions TransitR, bubblemanStage.transition.5
	configureMapLimits OrientationFoward, OrientationHor, 12, 1

bubblemanStage.transition.5:
	.db LoadNewPaletteFlag
	
	;border color
	.db PaletteNewAddressMark | 16
	.db $34
bubblemanPalette:
	.db PaletteNewAddressMark | 24
	.db $08 | PaletteEndingMark
	
	configureMapLimits OrientationFoward, OrientationHor, 13, 1
.ends

.endif